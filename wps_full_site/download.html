<!DOCTYPE html> <html lang="en"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <title>WPS Office Download</title> </head> <body> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-126693142-4"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-126693142-4'); </script> <script> var BAK_DOWNLOAD_URL = '//wdl1.pcfg.cache.wpscdn.com/wpsdl/wpsoffice/onlinesetup/distsrc/200.1087/wpsinst/wps_office_inst.exe'; function getDownloadUrl(channel) { return '//wdl1.pcfg.cache.wpscdn.com/wpsdl/wpsoffice/onlinesetup/distsrc/' + channel + '/wpsinst/wps_office_inst.exe'; } function getQueryString(name, url) { var pattern = new RegExp('[\\?&#]' + name + '=([^&#]+)', 'gi'); var ma = (url || location.search).match(pattern); var strArr; if (ma && ma.length > 0) { strArr = ma[ma.length - 1].split('='); if (strArr && strArr.length > 1) { return strArr[1]; } return ''; } return ''; } function getName(wid, aid, fid, lid) { var name = ''; if (lid) { name = `wps_lid.${lid}.exe`; } else if (wid) { name = `wps_wid.${wid}.exe`; } else if (aid) { name = `wps_aid.${aid}.exe`; } else if (fid) { name = `wps_fid.${fid}.exe`; } return name; } function goDownload(url, name) { var link = document.createElement('a'); link.style.display = 'none'; link.href = url; link.setAttribute('download', name); document.body.appendChild(link); link.click(); setTimeout(function() { document.body.removeChild(link); }, 1000); } var autodownload = getQueryString('autodownload', window.location.href); var wid = getQueryString('wid', window.location.href); var aid = getQueryString('aid', window.location.href); var fid = getQueryString('fid', window.location.href); var lid = getQueryString('lid', window.location.href); var channel = getQueryString('channel', window.location.href); var downloadUrl = channel ? getDownloadUrl(channel) : BAK_DOWNLOAD_URL; var name = getName(wid, aid, fid, lid); if (autodownload === 'false') { window.addEventListener('message', function(res) { if (res.data.eventName === 'download') { if (res.data.eventParams && res.data.eventParams.channel) { var paramChannel = res.data.eventParams.channel; downloadUrl = paramChannel ? getDownloadUrl(paramChannel) : BAK_DOWNLOAD_URL; } goDownload(downloadUrl, name); } }); } else { goDownload(downloadUrl, name); } </script> </body> </html>